class c{value;listeners=new Set;static all=Symbol("all");constructor(t){this.value=t;this.value=t}subscribe(t){this.listeners.add(t)}unsubscribe(t){this.listeners.delete(t)}get(t){if(t===void 0)return this.value;if(typeof this.value==="object"&&this.value!==null)return this.value[t];return}set(t,e=null){if(e===null)this.value=t;else if(typeof this.value==="object"&&this.value!==null)this.value[t]=e;else throw new Error("[error] cannot assign a value to a non-object value");this.listeners.forEach((i)=>i(this.value,[e!==null?t:c.all]));return}getAll(){return this.value}static merge(t,e){let i=new c({}),r=new Set([...Object.keys(t.getAll()),...Object.keys(e.getAll())]);for(let n of r){let o=t.get(n),s=e.get(n);if(o!==void 0&&s!==void 0)i.set(n,c.merge(o,s));else if(o!==void 0)i.set(n,o);else if(s!==void 0)i.set(n,s)}return i}destroy(){this.listeners.clear(),this.value=null}isNull(){return this.value===null}init(){this.listeners.clear(),this.value={}}}class l{static counter=0;id=`c-${l.counter++}`;tagName="div";className="";children=[];attributes={};state=new c({});events={};text="";parent=null;onRenderFunctions=[];onUpdateFunctions=[];onDestroyFunctions=[];styles={};constructor(t={}){for(let e in t)this.state.set(e,t[e])}onRender(t){return this.onRenderFunctions.push(t),this}onUpdate(t){return this.onUpdateFunctions.push(t),this}onDestroy(t){return this.onDestroyFunctions.push(t),this}withId(t){return this.id=t,this}withClassName(t){return this.className=this.className+" "+t,this}withChild(t){return t.parent=this,this.children.push(t),this}withChildren(...t){for(let e of t)this.withChild(e);return this}withStyles(t){return this.styles={...this.styles,...t},this}withClassNames(...t){return t.map(this.withClassName.bind(this)),this}withAttribute(t,e){return this.attributes[t]=e,this}withAttributes(t){return Object.keys(t).map((e)=>this.withAttribute(e,t[e])),this}on(t,e){if(!this.events[t])this.events[t]=e;else{let i=this.events[t];this.events[t]=(r)=>{i(r),e(r)}}return this}onClick(t){return this.on("click",t),this}onEnter(t){return this.on("mouseenter",t),this}onLeave(t){return this.on("mouseleave",t),this}onFocus(t){return this.on("focus",t),this}as(t){return this.tagName=t,this}onBlur(t){return this.on("blur",t),this}onDoubleClick(t){return this.on("dblclick",t),this}onMouseDown(t){return this.on("mousedown",t),this}onMouseUp(t){return this.on("mouseup",t),this}onMouseMove(t){return this.on("mousemove",t),this}withText(t){return this.text=t,this}}var C=new Map;function y(t,e){if(t===e)return;if(t.tagName!==e.tagName){t.replaceWith(e);return}let i=t.attributes,r=e.attributes;for(let s=0;s<r.length;s++)C.set(r[s].name,r[s].value);for(let s=i.length-1;s>=0;s--){let u=i[s].name;if(!C.has(u))t.removeAttribute(u)}for(let s=0;s<r.length;s++){let u=r[s].name;if(t.getAttribute(u)!==r[s].value)t.setAttribute(u,r[s].value)}let n=[...t.childNodes],o=[...e.childNodes];for(let s=0;s<o.length||s<n.length;s++)if(!o[s])t.removeChild(n[s]);else if(!n[s])t.appendChild(o[s].cloneNode(!0));else if(n[s].nodeType===Node.TEXT_NODE&&o[s].nodeType===Node.TEXT_NODE){if(n[s].textContent!==o[s].textContent)n[s].textContent=o[s].textContent}else if(n[s].nodeName!==o[s].nodeName)t.replaceChild(o[s].cloneNode(!0),n[s]);else y(n[s],o[s])}import{Parser as L}from"expr-eval";var A="0.0.1";var O=/{{(.*?)}}/g,S=new L,P={pastel_version:A};function g(t,e){let i={...e,...P};return t.replace(O,(r,n)=>{try{let o=S.parse(n).evaluate(i);return String(o)}catch(o){return""}})}var b=!1,v={};function H(){let t=document.getElementById("pastel__global_styles");if(!t)t=document.createElement("style"),t.id="pastel__global_styles",document.head.appendChild(t);t.textContent=Object.entries(v).map(([e,i])=>`#${e} { ${Object.entries(i).map(([r,n])=>`${r}: ${n}`).join("; ")} }`).join(`
`)}function I(t){let e,i=new c({});e=t;while(e)i=c.merge(i,e.state),e=e.parent;return i}function M(t,e){for(let i of e)if(i.allows(t))i.apply(t);return t}function _(t,e=!1){if(window.pastel?.pipelines)t=M(t,window.pastel?.pipelines);let{tagName:i,attributes:r,children:n,events:o,text:s}=t,{className:u,styles:d}=t,p=I(t),a=document.createElement(i);for(let[h,f]of Object.entries(r)){if(h==="class"){u+=" "+g(f.toString(),p.getAll());continue}a.setAttribute(h,g(f.toString(),p.getAll()))}if(d&&v[t.id]!==d&&Object.keys(d).length>0)v[t.id]=d,H();if(a.className=g(u,p.getAll()),s)a.textContent=s;a.innerText=g(a.innerText,p.getAll());for(let h of n)a.appendChild(_(h,e));for(let[h,f]of Object.entries(o))a.addEventListener(h,f);if(e&&t.state)t.state.subscribe(()=>{if(b)return;b=!0,y(a,_(t)),N(t),b=!1});return a.id=t.id,a}function k(t){for(let e of t.onRenderFunctions){if(typeof e!=="function"){console.warn("[pastel] onRender function is not a function");continue}e()}for(let e of t.children)k(e)}function m(t){let e=null;for(let i of t.onDestroyFunctions){if(typeof i!=="function"){console.warn("[pastel] onDestroy function is not a function");continue}e=i()??!1}for(let i of t.children)m(i);return e}function N(t){if(t.onUpdateFunctions.length>50&&!window.PASTEL_NO_PERFORMANCE_WARN)console.warn(`[pastel] you have more than 50 onUpdate functions, this is not recommended for performance reasons
you can disable this warning by setting window.PASTEL_NO_PERFORMANCE_WARN to true`);for(let e of t.onUpdateFunctions){if(typeof e!=="function"){console.warn("[pastel] onUpdate function is not a function");continue}e()}for(let e of t.children)N(e)}function w(t,e=!1){if(b)return;if(b=!0,t.state.isNull())t.state.init();k(t);let i=_(t,!0);if(window.addEventListener("beforeunload",(r)=>{if(m(t))r.preventDefault()}),e)document.body.innerHTML="";document.body.appendChild(i),b=!1}class $ extends l{constructor(t={}){super(t);this.as("button")}}class F extends l{constructor(t,e={}){super(e);if(t<1||t>6)throw new Error("Header level must be between 1 and 6");this.as("h"+t)}}class U extends l{constructor(t={}){super(t);this.as("p")}}class D extends l{constructor(t,e={}){super(e);this.text=t}}class W extends l{constructor(t={}){super(t);this.as("div")}}class R extends l{constructor(t="",e={}){super(e);if(this.as("a"),t)this.attributes.href=t}withLink(t){return this.attributes.href=t,this}withBlankTarget(){return this.attributes.target="_blank",this}withRel(t){return this.attributes.rel=t,this}}class j extends R{constructor(t="",e={}){super("#"+t,e)}withLink(t){return this.attributes.href="#"+t,this}}class B extends l{constructor(t,e={}){super(e);this.as("img"),this.attributes.src=t}withAlt(t){return this.attributes.alt=t,this}withWidth(t){return this.attributes.width=t.toString(),this}withHeight(t){return this.attributes.height=t.toString(),this}}class V extends l{constructor(t="text",e={}){super();this.as("input"),this.attributes.type=t}withValue(t){return this.attributes.value=t,this}withPlaceholder(t){return this.attributes.placeholder=t,this}withRequired(){return this.attributes.required=!0,this}withDisabled(){return this.attributes.disabled=!0,this}withReadOnly(){return this.attributes.readOnly=!0,this}withAutofocus(){return this.attributes.autofocus=!0,this}withMin(t){return this.attributes.min=t.toString(),this}withMax(t){return this.attributes.max=t.toString(),this}onInput(t){return this.on("input",t),this}}class x{title;links=[];meta_tags=[];scripts=[];styles=[];constructor(t){this.title=t}addLink(t,e,i={}){this.links.push({type:t,href:e,data:i})}addMeta(t,e){this.meta_tags.push({name:t,content:e})}addScript(t,e=!1){this.scripts.push({src:t,async:e})}addStyle(t){this.styles.push(t)}withLink(t,e){return this.links.push({type:t,href:e,data:{}}),this}withMeta(t,e){return this.meta_tags.push({name:t,content:e}),this}withScript(t,e=!1){return this.scripts.push({src:t,async:e}),this}withStyle(t){return this.styles.push(t),this}render(){if(!this.meta_tags.some((e)=>e.name==="viewport"))this.addMeta("viewport","width=device-width, initial-scale=1.0");if(!this.meta_tags.some((e)=>e.name==="charset"))this.addMeta("charset","utf-8");let t=document.getElementsByTagName("title")[0];if(!t)t=document.createElement("title"),document.head.appendChild(t);t.textContent=this.title;for(let e of this.meta_tags){let i=document.createElement("meta");i.setAttribute("name",e.name),i.setAttribute("content",e.content),document.head.appendChild(i)}for(let e of this.links){let i=document.createElement("link");if(i.setAttribute("rel",e.type),i.setAttribute("href",e.href),e.data)i.innerHTML=this.render_link_data(e.data);document.head.appendChild(i)}for(let e of this.scripts){let i=document.createElement("script");if(i.setAttribute("src",e.src),e.async)i.setAttribute("async","");document.head.appendChild(i)}for(let e of this.styles){let i=document.createElement("style");i.textContent=e,document.head.appendChild(i)}}render_link_data(t){return Object.entries(t).map(([e,i])=>`${e}="${i}"`).join(" ")}}function T(t,e=new x("Pastel App")){e.render(),w(t)}class q{routes={};current_route;current_hash=window.location.hash;head;did_halt_destroy=!1;parse_hash(t){return t.split("#")[1]??null}constructor(t,e){let i=this.parse_hash(window.location.hash)??"/";this.routes=t,this.head=e,this.current_route=this.routes[i]||this.routes["/"]||this.routes["/default"]}listen(){window.addEventListener("hashchange",(t)=>{this.handle_hashchange(window.location.hash,this.parse_hash(t.oldURL)||"/")}),T(this.current_route,this.head)}navigate(t){window.location.hash=t}handle_hashchange(t,e){if(this.did_halt_destroy){this.did_halt_destroy=!1;return}let i=this.parse_hash(t),r=this.current_route;if(m(r)===!0&&!window.PASTEL_NO_ROUTE_HALT){if(!window.PASTEL_NO_ROUTE_HALT_WARN)console.warn(`we attempted to destroy ${e}, but it halted the process of rendering the next route.
to disable this, set window.PASTEL_NO_ROUTE_HALT to true,
or, to just disable the warning, set window.PASTEL_NO_ROUTE_HALT_WARN to true`);window.location.hash=e,this.did_halt_destroy=!0;return}if(i===null||!this.routes[i])this.current_route=this.routes["/404"]||this.routes["/default"]||this.routes["/"];else this.current_route=this.routes[i];w(this.current_route,!0)}}class z{steps;avoided=[];_whitelist=null;_blacklist=null;constructor(t){this.steps=t}apply(t){if(this.steps.length>50&&!window.PASTEL_NO_PIPELINE_WARN)console.warn(`[pastel] pipeline has more than 50 steps, this may cause performance issues
you can disable this warning by setting window.PASTEL_NO_PIPELINE_WARN to true`);for(let e of this.steps){if(typeof e.function!=="function")console.warn("[pastel] pipeline step is not a function");if(!this.allows(t,e))continue;switch(e.modifier){case"className":t.className=e.function(t.className);break;case"attribute":for(let i of Object.keys(t.attributes))t.attributes[i]=e.function(t.attributes[i]);break;case"attributes":t.attributes=e.function(t.attributes);break;case"text":t.text=e.function(t.text);break;case"id":t.id=e.function(t.id);break;case"style":t.styles=e.function(t.styles);break;default:console.warn("[pastel] unknown pipeline modifier: "+e.modifier);break}}return t}avoid(t){return this.avoided.push(t),this}whitelist(t){return this._whitelist=[...this._whitelist||[],...t],this}blacklist(t){return this._blacklist=[...this._blacklist||[],...t],this}has(t,e,i,r){let n=new Set(t);return n.has(r)||e.some((o)=>n.has(o))||n.has(i)}allows(t,e=this){let i=t.tagName,{className:r,id:n}=t,o=r.split(" ").map((f)=>"."+f),s=Array.isArray(e._whitelist)?e._whitelist:Array.isArray(e.whitelist)?e.whitelist:null,u=Array.isArray(e._blacklist)?e._blacklist:Array.isArray(e.blacklist)?e.blacklist:[],d=Array.isArray(e.avoided)?e.avoided:[],p=s&&this.has(s,o,"#"+n,i),a=u&&this.has(u,o,n,i),h=d.includes(t);return!a&&!h&&(p||!s)}mount(){if(!window.pastel)window.pastel={};window.pastel.pipelines=window.pastel.pipelines||[],window.pastel.pipelines.push(this)}unmount(){if(!window.pastel||!window.pastel.pipelines||!window.pastel.pipelines.length||!window.pastel.pipelines.includes(this)){console.warn("[pastel] this pipeline is not mounted, but you are trying to unmount it");return}window.pastel.pipelines=window.pastel.pipelines.filter((t)=>t!==this)}}var E=new c({width:window.innerWidth,height:window.innerHeight,title:window.document.title});window.addEventListener("resize",()=>{E.set("width",window.innerWidth),E.set("height",window.innerHeight)});E.subscribe((t,e)=>{if(e.includes("title"))window.document.title=t.title;else if(e.includes("width")||e.includes("height"))window.resizeTo(t.width,t.height)});export{g as render_template,T as render,y as apply_diffs,D as Text,j as RouterLink,q as Router,z as Pipeline,U as Paragraph,A as PASTEL_VERSION,R as Link,V as Input,B as Image,F as Header,x as Head,W as Div,l as Component,$ as Button,E as $window,c as $reactive};

//# debugId=D8C1E4B76189A39C64756E2164756E21
